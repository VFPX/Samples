*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="fadeaway.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	Name = "Dataenvironment"

ENDDEFINE

DEFINE CLASS frmsolution AS frmsolution OF "..\solution.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Olecontrol1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />

	AlwaysOnTop = .T.
	Caption = "Transparent Forms"
	DoCreate = .T.
	Height = 250
	HelpContextID = 1231673
	Name = "frmsolution"
	ShowWindow = 2
	Width = 350
	Behindscenes1.Left = 12
	Behindscenes1.Name = "Behindscenes1"
	Behindscenes1.Top = 220
	Cmdclose1.Left = 268
	Cmdclose1.Name = "Cmdclose1"
	Cmdclose1.Top = 220
	C_solutions1.Left = 156
	C_solutions1.Name = "C_solutions1"
	C_solutions1.Top = 228
	Label1.AutoSize = .T.
	Label1.Caption = "Use the slider below to add new layered windows effects - transparency. You can also use these new APIs to add cool shadow effects. This sample requires Windows 2000 or NT4 SP6."
	Label1.Height = 41
	Label1.Left = 19
	Label1.Name = "Label1"
	Label1.Top = 22
	Label1.Width = 320
	Label4.Name = "Label4"
	Shape2.Height = 60
	Shape2.Left = 11
	Shape2.Name = "Shape2"
	Shape2.Top = 12
	Shape2.Width = 327

	ADD OBJECT 'Label2' AS label WITH ;
		Caption = "Transparency", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 132, ;
		Name = "Label2", ;
		Top = 82, ;
		Width = 77
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		Caption = "Max", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 36, ;
		Name = "Label3", ;
		Top = 136, ;
		Width = 24
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		Caption = "Min", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 276, ;
		Name = "Label5", ;
		Top = 136, ;
		Width = 24
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Olecontrol1' AS olecontrol WITH ;
		Height = 36, ;
		Left = 36, ;
		Name = "Olecontrol1", ;
		Top = 96, ;
		Width = 264
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\winnt\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJCGl28v18ABAwAAAMABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAEUAAAAAAAAABAAAAAIAAAD+////BgAAAAUAAAD+/////v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9U+Y3wkoXREbFqAMDwKDYoIUM0EggAAABJGwAAuQMAABGuKwoAAAYAHAAAAAAAAAAFAAAAAQAAAAoAAAAZAAAAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTExAEQAMQAtADgAQgA2AEYALQAwADgAMAAwADMANgBCADEAMQABAACABAAAAE1heAAJAAAASQoAAAAZAAAABAAAAE1pbgAJAAAASQoAAAAKAAAABgAAAFZhbHVlAAkAAABJCgAAAAAAABkAAAAAAAAAAAAAAAEAAAAZAAAAAAAAAAHvzasAAAUA0E8CAgYAAAD///////////DsEgAf3uy9AQAFAPDsEgBQAHIAbwBjAFMAZQByAHYAZQByADMAMgAAADEALQA4AEIANgBGAC0AMAA4ADAAMAAzADYAQgAxADEAQQAAGQAAAABcAEkAbgBQAHIAbwBjAFMAZQATAGERAAByABACEwAQAhMAAAAAAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACiABAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'Shape1' AS shape WITH ;
		BackColor = 255,0,0, ;
		Height = 36, ;
		Left = 24, ;
		Name = "Shape1", ;
		Top = 156, ;
		Width = 100
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape3' AS shape WITH ;
		BackColor = 0,0,255, ;
		Height = 36, ;
		Left = 222, ;
		Name = "Shape3", ;
		Top = 156, ;
		Width = 100
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape4' AS shape WITH ;
		BackColor = 255,255,255, ;
		Height = 36, ;
		Left = 123, ;
		Name = "Shape4", ;
		Top = 156, ;
		Width = 100
		*< END OBJECT: BaseClass="shape" />
	
	PROCEDURE Destroy
		CLEAR DLLS _Sol_SetWindowLong
		CLEAR DLLS _Sol_SetLayeredWindowAttributes
		
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		#DEFINE BADOS_LOC	"This sample only runs on Windows 2000 or higher."
		
		IF VAL(OS(3))<5
			MESSAGEBOX(BADOS_LOC)
			RETURN .F.
		ENDIF
		
		DECLARE SetWindowLong In Win32Api AS _Sol_SetWindowLong Integer, Integer, Integer
		DECLARE SetLayeredWindowAttributes In Win32Api AS _Sol_SetLayeredWindowAttributes Integer, String, Integer, Integer
		_Sol_SetWindowLong(THISFORM.hWnd, -20, 0x00080000)
		_Sol_SetLayeredWindowAttributes(THISFORM.hWnd, 0, 255, 2)
		THISFORM.Olecontrol1.SetFocus()
	ENDPROC

	PROCEDURE Olecontrol1.Change
		*** ActiveX Control Event ***
		LOCAL lnValue
		DO CASE
		CASE THIS.Value = 0
			lnValue = 0
		CASE THIS.Value = 25
			lnValue = 255
		OTHERWISE
			lnValue = THIS.Value * 10
		ENDCASE
		_Sol_SetLayeredWindowAttributes(THISFORM.hWnd, 0, lnValue, 2)
		
	ENDPROC

ENDDEFINE
