*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="agent.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "_agent.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS frmsolution1 AS frmsolution OF "..\solution.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="_agent" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lbxAnimations" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdPlay" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdStop" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdPeedy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdRobby" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdGenie" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdMerlin" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdShowTime" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtSpeak" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdSpeak" UniqueID="" Timestamp="" />

	Caption = "Working with Microsoft Agent"
	DoCreate = .T.
	Height = 280
	HelpContextID = 1231624
	Name = "Frmsolution1"
	Width = 343
	Behindscenes1.Left = 12
	Behindscenes1.Name = "Behindscenes1"
	Behindscenes1.TabIndex = 12
	Behindscenes1.Top = 252
	Behindscenes1.ZOrderSet = 2
	Cmdclose1.Left = 264
	Cmdclose1.Name = "Cmdclose1"
	Cmdclose1.TabIndex = 14
	Cmdclose1.Top = 252
	Cmdclose1.ZOrderSet = 4
	C_solutions1.Left = 228
	C_solutions1.Name = "C_solutions1"
	C_solutions1.Top = 252
	Label1.Caption = "Click an Agent Button to show an Agent. You can then perform an action by selecting one from the list on the left and pressing the Play button. You can also have the agent speak some text by typing it in the box below and pressing the Speak button."
	Label1.Height = 60
	Label1.Left = 19
	Label1.Name = "Label1"
	Label1.TabIndex = 13
	Label1.Top = 24
	Label1.Width = 314
	Label1.ZOrderSet = 3
	Label4.Name = "Label4"
	Label4.TabIndex = 1
	Label4.ZOrderSet = 5
	Shape2.Height = 72
	Shape2.Left = 12
	Shape2.Name = "Shape2"
	Shape2.Top = 12
	Shape2.Width = 324
	Shape2.ZOrderSet = 0

	ADD OBJECT '_agent' AS _agent WITH ;
		Height = 24, ;
		Left = 60, ;
		Name = "_agent", ;
		Top = 252, ;
		Width = 24
		*< END OBJECT: ClassLib="..\..\..\ffc\_agent.vcx" BaseClass="custom" />

	ADD OBJECT 'cmdGenie' AS commandbutton WITH ;
		Caption = "Genie", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 264, ;
		Name = "cmdGenie", ;
		TabIndex = 5, ;
		Top = 168, ;
		Width = 72, ;
		ZOrderSet = 12
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdMerlin' AS commandbutton WITH ;
		Caption = "Merlin", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 264, ;
		Name = "cmdMerlin", ;
		TabIndex = 4, ;
		Top = 144, ;
		Width = 72, ;
		ZOrderSet = 13
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdPeedy' AS commandbutton WITH ;
		Caption = "Peedy", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 264, ;
		Name = "cmdPeedy", ;
		TabIndex = 3, ;
		Top = 120, ;
		Width = 72, ;
		ZOrderSet = 10
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdPlay' AS commandbutton WITH ;
		Caption = "Play", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 144, ;
		Name = "cmdPlay", ;
		TabIndex = 7, ;
		Top = 96, ;
		Width = 72, ;
		ZOrderSet = 8
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdRobby' AS commandbutton WITH ;
		Caption = "Robby", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 264, ;
		Name = "cmdRobby", ;
		TabIndex = 2, ;
		Top = 96, ;
		Width = 72, ;
		ZOrderSet = 11
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdShowTime' AS commandbutton WITH ;
		Caption = "Showtime!", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 144, ;
		Name = "cmdShowTime", ;
		TabIndex = 9, ;
		Top = 168, ;
		Width = 72, ;
		ZOrderSet = 14
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdSpeak' AS commandbutton WITH ;
		Caption = "Speak", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 264, ;
		Name = "cmdSpeak", ;
		TabIndex = 11, ;
		Top = 204, ;
		Width = 72, ;
		ZOrderSet = 16
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdStop' AS commandbutton WITH ;
		Caption = "Stop", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 144, ;
		Name = "cmdStop", ;
		TabIndex = 8, ;
		Top = 120, ;
		Width = 72, ;
		ZOrderSet = 9
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'lbxAnimations' AS listbox WITH ;
		FontSize = 8, ;
		Height = 96, ;
		Left = 12, ;
		Name = "lbxAnimations", ;
		Sorted = .T., ;
		TabIndex = 6, ;
		Top = 96, ;
		Width = 120, ;
		ZOrderSet = 7
		*< END OBJECT: BaseClass="listbox" />

	ADD OBJECT 'txtSpeak' AS textbox WITH ;
		Alignment = 3, ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 12, ;
		Name = "txtSpeak", ;
		TabIndex = 10, ;
		Top = 204, ;
		Value = ("hello"), ;
		Width = 240, ;
		ZOrderSet = 15
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE cmdGenie.Click
		If thisform._agent.load("Genie","genie.acs")
		  thisform._agent.setActiveAgent("Genie")	
		  thisform._agent.show(Rand() * 400, Rand() * 400)
		  thisform.lbxAnimations.Requery()
		Else
		  =MessageBox( GENIE_NOT_INSTALLED_LOC, MB_ICONSTOP)
		Endif
	ENDPROC

	PROCEDURE cmdMerlin.Click
		If thisform._agent.load("Merlin","merlin.acs")
		  thisform._agent.setActiveAgent("Merlin")	
		  thisform._agent.show(Rand() * 400, Rand() * 400)
		  thisform.lbxAnimations.Requery()
		Else
		  =MessageBox( MERLIN_NOT_INSTALLED_LOC, MB_ICONSTOP)
		Endif
	ENDPROC

	PROCEDURE cmdPeedy.Click
		If thisform._agent.load("Peedy","peedy.acs")
		  thisform._agent.setActiveAgent("Peedy")	
		  thisform._agent.show(Rand() * 400, Rand() * 400)
		  thisform.lbxAnimations.Requery()
		Else
		  =MessageBox( PEEDY_NOT_INSTALLED_LOC, MB_ICONSTOP)
		Endif
		
	ENDPROC

	PROCEDURE cmdPlay.Click
		thisform._agent.play(Alltrim(thisform.lbxAnimations.DisplayValue))
		
	ENDPROC

	PROCEDURE cmdRobby.Click
		If thisform._agent.load("Robby","Robby.acs")
		  thisform._agent.setActiveAgent("Robby")
		  thisform._agent.show(Rand() * 400, Rand() * 400)
		  thisform.lbxAnimations.Requery()
		Else
		  =MessageBox(ROBBY_NOT_INSTALLED_LOC, MB_ICONSTOP)
		ENDIF
		
	ENDPROC

	PROCEDURE cmdShowTime.Click
		With thisform._agent
		
			If .load("Peedy", "Peedy.acs") And .load("Merlin", "Merlin.acs")
				If .load("Genie", "Genie.acs")
		        	If .setActiveAgent("Genie")
		        		.hide()
		        	Endif
		        Endif
		  
				If .load("Robby", "Robby.acs")
		        	If .setActiveAgent("Robby")
		        		.hide()
		        	Endif
		        EndIf
		
		    	If .setActiveAgent("Peedy")
		    		.hide()
		    	Endif
		
		    	If .setActiveAgent("Merlin")
		    		.hide()
		    	Endif
		
		    	.setActiveAgent("Peedy")
		    	.show(400,200)
		
		    	.setActiveAgent("Merlin")
		    	.show(200,200)
		    	.play("Announce")
		    	.play("GestureLeft")
		    	loMReq = .Speak(ST_M_01_LOC)
		    	
		    	.setActiveAgent("Peedy")
		    	.wait(loMReq)
		    	.play("lookright")
		    	loPReq = .Speak(ST_P_01_LOC)
		    	.play("lookrightreturn")
		    	
		    	.setActiveAgent("Merlin")
		    	.wait(loPReq)
		    	.play("Explain")
		    	loMReq = .Speak(ST_M_02_LOC)
		    	.play("LookLeft")
		    	
		    	.setActiveAgent("Peedy")
		    	.wait(loMReq)
		    	.play("think")
		    	loPReq = .Speak(ST_P_02_LOC)
		    	.play("restpose")
		    	
		    	.setActiveAgent("Merlin")
		    	.wait(loPReq)
		    	.play("lookleftreturn")
		    	.play("Pleased")
		    	.Speak(ST_M_03_LOC)
		    	loMReq = .play("surprised")
		    	
		    	.setActiveAgent("Peedy")
		    	.wait(loMReq)
		    	.Speak(ST_P_03_LOC)
		    	.moveTo(250,200)
		    	loPReq = .play("domagic1")
		    	.play("domagic2")
		    	
		    	.setActiveAgent("Merlin")
		    	.wait(loPReq)
		    	.hide()
		    	
		    	.setActiveAgent("Peedy")
		    	.play("Pleased")
		    	.hide()
		    Else
		    	=MessageBox(SHOWTIME_REQUIREMENTS_LOC, MB_ICONSTOP)
			Endif		
		EndWith
	ENDPROC

	PROCEDURE cmdSpeak.Click
		thisform._agent.speak(this.parent.txtSpeak.value)
		
		
	ENDPROC

	PROCEDURE cmdStop.Click
		thisform._agent.stop()
	ENDPROC

	PROCEDURE lbxAnimations.Requery
		this.clear()
		For Each lcAnimation In thisform._agent.activeAgent.animationNames
			this.addItem(lcAnimation)
		EndFor
	ENDPROC

ENDDEFINE
