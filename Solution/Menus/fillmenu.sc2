*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="fillmenu.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	Height = 152
	Left = 84
	Name = "Dataenvironment"
	Top = 228
	Width = 450

ENDDEFINE

DEFINE CLASS form1 AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="txtPrompt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtMessage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lstMenu" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdRefresh" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdAdd" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdRemove" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="C_solutions1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Behindscenes1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdClose" UniqueID="" Timestamp="" />

	BorderStyle = 2
	Caption = "Add Menu Items at Runtime"
	DataSession = 2
	DoCreate = .T.
	Height = 277
	HelpContextID = 1231504
	Left = 0
	MaxButton = .F.
	Name = "Form1"
	Top = 0
	Width = 401

	ADD OBJECT 'Behindscenes1' AS behindscenes WITH ;
		Left = 11, ;
		Name = "Behindscenes1", ;
		TabIndex = 9, ;
		Top = 244
		*< END OBJECT: ClassLib="..\solution.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'C_solutions1' AS c_solutions WITH ;
		Height = 18, ;
		Left = 23, ;
		Name = "C_solutions1", ;
		Top = 212, ;
		Width = 25
		*< END OBJECT: ClassLib="..\solution.vcx" BaseClass="custom" />

	ADD OBJECT 'cmdAdd' AS commandbutton WITH ;
		Caption = "\<Add ", ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 320, ;
		Name = "cmdAdd", ;
		TabIndex = 5, ;
		Top = 134, ;
		Width = 72
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdClose' AS cmdclose WITH ;
		Left = 320, ;
		Name = "cmdClose", ;
		TabIndex = 10, ;
		Top = 244
		*< END OBJECT: ClassLib="..\solution.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdRefresh' AS commandbutton WITH ;
		Caption = "\<Refresh", ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 320, ;
		Name = "cmdRefresh", ;
		TabIndex = 8, ;
		Top = 203, ;
		Width = 72
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdRemove' AS commandbutton WITH ;
		Caption = "Remo\<ve", ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 320, ;
		Name = "cmdRemove", ;
		TabIndex = 6, ;
		Top = 162, ;
		Width = 72
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Label1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "\<Prompt:", ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 21, ;
		Name = "Label1", ;
		TabIndex = 1, ;
		Top = 84, ;
		Width = 38
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Me\<ssage:", ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 13, ;
		Name = "Label2", ;
		TabIndex = 3, ;
		Top = 111, ;
		Width = 48
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		Caption = "Type the text of the menu item in the Prompt text box and click Add to add the menu item to the list.  Click Refresh to update the menu with the list of menu items.", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 43, ;
		Left = 18, ;
		Name = "Label5", ;
		TabIndex = 0, ;
		Top = 24, ;
		Width = 366, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		AutoSize = .T., ;
		Caption = " Instructions ", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 18, ;
		Name = "Label6", ;
		TabIndex = 0, ;
		Top = 8, ;
		Width = 62
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lstMenu' AS listbox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "200,0", ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 132, ;
		Left = 64, ;
		MoverBars = .T., ;
		Name = "lstMenu", ;
		TabIndex = 7, ;
		Top = 135, ;
		Width = 244
		*< END OBJECT: BaseClass="listbox" />

	ADD OBJECT 'Shape2' AS shape WITH ;
		BackStyle = 0, ;
		Height = 58, ;
		Left = 10, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 14, ;
		Width = 382
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'txtMessage' AS textbox WITH ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 64, ;
		Name = "txtMessage", ;
		TabIndex = 4, ;
		Top = 105, ;
		Width = 243
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtPrompt' AS textbox WITH ;
		FontBold = .F., ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 64, ;
		Name = "txtPrompt", ;
		TabIndex = 2, ;
		Top = 80, ;
		Width = 122
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE Activate
		THIS.c_solutions1.saveHelp
	ENDPROC

	PROCEDURE Deactivate
		IF TYPE("THIS.c_solutions1") = "O" THEN
			THIS.c_solutions1.restoreHelp
		ENDIF
	ENDPROC

	PROCEDURE Init
		IF  fontmetric(1, 'MS Sans Serif', 8, '') # 13 OR ;
			fontmetric(4, 'MS Sans Serif', 8, '') # 2 OR ;
			fontmetric(6, 'MS Sans Serif', 8, '') # 5 OR ;
			fontmetric(7, 'MS Sans Serif', 8, '') # 11
			this.setall('fontname', 'Tahoma')  
		ELSE
			this.setall('fontname','MS Sans Serif')
		ENDIF
		this.setall('fontsize',8)
		
		
	ENDPROC

	PROCEDURE Unload
		RELEASE PAD dynmenu OF _MSYSMENU
	ENDPROC

	PROCEDURE cmdAdd.Click
		oList = THISFORM.lstMenu
		nPosition = THISFORM.lstMenu.ListCount + 1
		oList.AddListItem(THISFORM.txtPrompt.Value,nPosition,1)
		oList.AddListItem(THISFORM.txtMessage.Value,nPosition,2)
		
		oList.ListIndex = nPosition
		
		THISFORM.txtPrompt.Value = ""
		THISFORM.txtMessage.Value = ""
		
		THISFORM.txtPrompt.SetFocus
	ENDPROC

	PROCEDURE cmdRefresh.Click
		DO dynamic.mpr
		
		FOR i = 1 TO THISFORM.lstMenu.ListCount
			DEFINE BAR i OF dynamicite PROMPT (ALLTRIM(THISFORM.lstMenu.List(i,1))) ;
				MESSAGE (THISFORM.lstMenu.List(i,2))
		ENDFOR
		
		DEFINE BAR i + 1 OF dynamicite PROMPT "\-"
		DEFINE BAR i + 2 OF dynamicite PROMPT "Release this menu" ;
			MESSAGE "Remove the Dynamic Items menu from the menu bar."
		
	ENDPROC

	PROCEDURE cmdRemove.Click
		nRow = THISFORM.lstMenu.ListIndex
		
		IF nRow = 0 && no items selected
			#DEFINE MSG_LOC "You need to select an item in the menu order list before removing it."
			WAIT WINDOW MSG_LOC TIMEOUT 1
			RETURN
		ENDIF
		
		THISFORM.txtPrompt.Value = THISFORM.lstMenu.List(nRow,1)
		THISFORM.txtMessage.Value = THISFORM.lstMenu.List(nRow,2)
		
		THISFORM.lstMenu.RemoveItem(nRow)
	ENDPROC

	PROCEDURE lstMenu.DblClick
		THISFORM.cmdRemove.Click
	ENDPROC

	PROCEDURE lstMenu.InteractiveChange
		nRow = THIS.ListIndex
		THISFORM.txtPrompt.Value = THIS.List(nRow,1)
		THISFORM.txtMessage.Value = THIS.List(nRow,2)
		
	ENDPROC

	PROCEDURE txtMessage.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		IF nKeyCode = 13 THEN
			THISFORM.cmdAdd.Click
		ENDIF
	ENDPROC

	PROCEDURE txtPrompt.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		IF nKeyCode = 13 THEN
			THISFORM.cmdAdd.Click
		ENDIF
	ENDPROC

ENDDEFINE
